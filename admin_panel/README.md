# Admin Panel

## Цель

Admin Panel отвечает за управление продуктами:
1. **Добавление новых товаров**
2. **Редактирование существующих товаров**

<br>

Сервис работает с авторизацией через `Auth Service` и взаимодействует с продуктовой базой данных, как и `Purchase Service`.

## Основная логика

- **Создание продукта** — администратор добавляет новый товар.
- **Обновление продукта** — можно изменить описание, название или количество.

Со всеми эндпоинтами (кроме `/health`) может работать только авторизованный пользователь.

## Зависимости

- `Auth Service` *(авторизация)*
- **PostgreSQL** *(хранит информацию о товарах)*
- **FastAPI**
- **SQLModel**
- **SQLAlchemy**
- **Pydantic**

А также побочные зависимости необходимые для работы `/shared`.<br>
Создание конфига *(из .env)* и движка БД происходит в `/shared/core`.<br>
Данная и другие операции для всех сервисов, где это требуется, были вынесена в отдельный модуль и 
подключаются как том в **Docker**, чтобы не повторять один и тот же код много раз.

## Инструкция по запуску

### 1. Написание .env файла

По образу и подобию `.env.example` необходимо сконфигурировать `.env` файл.<br>
При желании можно просто скопировать содержимое `.env.example`.<br>
Файл расположить на том же уровне, что и `.env.example`.

### 2. Запуск контейнера

```bash
docker-compose up --build admin_panel auth_service
```

После этого можно заходить на `http://localhost:8002/` и работать с сервисом через **Swagger**.

### 3. Работа в Swagger

При работе в Swagger следует не забывать об окне авторизации:

![Authorize](/assets/authorize.png)

Без неё роуты, требующее залогиненного пользователя работать **не будут**. <br>
Остальные инструкции описаны в документации внутри **Swagger**.

### 4. Удаление контейнера

Если есть необходимость в перезапуске, то надо удалять также и **тома**:

```bash
docker-compose up down -v
```

## Основные endpoints

| Метод | Путь                                   | Описание                                          |
|-------|----------------------------------------|---------------------------------------------------|
| POST  | `/admin/products/`                     | Добавление нового продукта                        |
| PATCH | `/admin/products/{product_id}`         | Обновление существующего продукта по ID           |
| GET   | `/health`                              | Проверка здоровья сервиса                         |