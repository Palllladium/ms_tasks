# ETL Process

## Цель

Сервис `etl_process` реализует процесс извлечения, трансформации и загрузки (ETL) данных из базы данных продуктов в хранилище **ElasticSearch**.

<br>

Служит мостом между `Product Service` и `Search Service`, обеспечивая актуальные данные для полнотекстового поиска.

## Основная логика

- Извлекает информацию о продуктах из базы данных PostgreSQL
- Обрабатывает и сериализует данные
- Загружает данные в индекс **ElasticSearch**
- Запускается при старте контейнера и выполняет полную перезапись данных в индекс

## Зависимости

- **PostgreSQL** — источник данных о продуктах
- **ElasticSearch** — целевая система хранения и поиска
- **FastAPI**, **SQLAlchemy**, **Pydantic**, **httpx**
- Локальный модуль `/shared` — общие утилиты: конфиги, подключения и модели

## Структура

- `main.py` — точка входа, запускает ETL процесс
- `etl.py` — логика обработки данных
- `extractor.py` — модуль извлечения из PostgreSQL
- `loader.py` — модуль загрузки в ElasticSearch

## Инструкция по запуску

### 1. Подготовка `.env` файла

Создайте `.env` по примеру `.env.example` в корне проекта. Он должен содержать параметры подключения к PostgreSQL 
и ElasticSearch и интервал времени пересылки данных между **БД** и **ES**.

### 2. Запуск контейнера

```bash
docker-compose up --build etl_process products_postgres elasticsearch
```

ETL выполнится автоматически при старте контейнера.

### 3. Удаление контейнера

Если необходимо пересобрать контейнер или очистить данные:

```bash
docker-compose down -v
```